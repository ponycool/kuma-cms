import{av as r,r as o,j as e,K as h,B as d,a as F,aj as s,af as v,aw as C,am as b,bb as w}from"./index.887e1024.js";import{U as B}from"./index.1a867338.js";import{D as c}from"./index.bf686981.js";import"./index.55eedb13.js";import{C as _}from"./index.cadb19cf.js";import{u as x,c as D}from"./index.00b9a643.js";import{c as p}from"./convertNullToUndefined.a19d8223.js";import{M as E}from"./index.f0456052.js";import"./index.a8c91ad8.js";import"./index.b35c3ab1.js";import"./index.bf4e9e68.js";import"./b-tween.es.064e2a03.js";function T(i){const[u]=r.useForm(),[f,n]=o.exports.useState(!1);async function g(){u.validate().then(async a=>{n(!0);const t=p(a);try{const m={...t,cover_image:t.cover_image&&t.cover_image.length!==0?t.cover_image[0].response.data.name:void 0,is_active:t.is_active?"true":"false",sort_index:t.sort_index||1,status:t.status};let l;i.data?l=await x({...m,uuid:i.data.uuid}):l=await D(m),l.code===0&&(i.reload(),i.close())}finally{n(!1)}}).catch(a=>{console.error(a)})}return o.exports.useEffect(()=>{if(i.data){const a=p(i.data);let t="";t=a.cover_image,u.setFieldsValue({...a,status:a.status,cover_image:a.cover_image?[{uid:a.cover_image,url:t,response:{data:{name:a.cover_image.replace("/media/image?n=",""),path:a.cover_image}}}]:[]})}},[i.data]),o.exports.useEffect(()=>{i.visible===!1&&u.resetFields()},[u,i.visible]),e(_,{title:i.data?"\u4FEE\u6539\u8BA1\u5212":"\u521B\u5EFA\u8BA1\u5212",extra:e(h,{style:{cursor:"point",color:"#333",fontSize:"16px"},onClick:()=>i.close()}),actions:[e(d,{type:"default",onClick:()=>i.close(),children:"\u53D6\u6D88"},"cancel"),e(d,{type:"primary",loading:f,onClick:g,children:i.data?"\u4FDD\u5B58":"\u521B\u5EFA"},"submit")],children:F(r,{form:u,labelCol:{span:2},wrapperCol:{span:22},children:[e(r.Item,{label:"\u6807\u9898",field:"name",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898"}],children:e(s,{maxLength:100,showWordLimit:!0,placeholder:"\u8BF7\u8F93\u5165\u6807\u9898"})}),e(r.Item,{label:"\u5C01\u9762",field:"cover_image",triggerPropName:"fileList",children:e(B,{action:"/api/upload/image",data:{token:JSON.parse(localStorage.getItem("token")).token},imagePreview:!0,accept:"image/png, image/jpg, image/jpeg",listType:"picture-card",limit:1})}),e(r.Item,{label:"\u5730\u5740",field:"location",wrapperCol:{span:4},children:e(s,{maxLength:50,placeholder:"\u8BF7\u8F93\u5165\u5730\u5740"})}),e(r.Item,{label:"\u5F00\u59CB\u65F6\u95F4",field:"start_datetime",wrapperCol:{span:4},children:e(c,{showTime:!0,format:"YYYY-MM-DD HH:mm:ss",style:{width:"100%"}})}),e(r.Item,{label:"\u7ED3\u675F\u65F6\u95F4",field:"end_datetime",wrapperCol:{span:4},children:e(c,{showTime:!0,format:"YYYY-MM-DD HH:mm:ss",style:{width:"100%"}})}),e(r.Item,{label:"\u72B6\u6001",field:"status",wrapperCol:{span:4},children:e(v,{options:Object.entries(i.status).map(([a,t])=>({label:t,value:a})),placeholder:"\u9009\u62E9\u72B6\u6001"})}),e(r.Item,{label:"\u6D4F\u89C8\u6B21\u6570",field:"view_count",wrapperCol:{span:2},disabled:!0,children:e(s,{})}),e(r.Item,{label:"\u6392\u5E8F",field:"sort_index",wrapperCol:{span:2},initialValue:1,rules:[{validator(a,t){a&&a<1?t("\u6392\u5E8F\u5FC5\u987B\u5927\u4E8E0"):t()}}],children:e(C,{maxLength:10,hideControl:!0,precision:0,placeholder:"\u6392\u5E8F"})}),e(r.Item,{label:"\u6D3B\u52A8\u72B6\u6001",field:"is_active",wrapperCol:{span:2},triggerPropName:"checked",initialValue:!1,children:e(b,{})}),e(w,{orientation:"left",children:"\u6B63\u6587"}),e(r.Item,{field:"content",wrapperCol:{span:24},triggerPropName:"html",trigger:"getContent",rules:[{required:!0},{validator(a,t){if(a==="<p><br></p>")return t("\u8BF7\u8F93\u5165\u6B63\u6587");t()}}],children:e(E,{})})]})})}export{T as default};
