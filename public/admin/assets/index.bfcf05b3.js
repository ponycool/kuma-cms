import{h as d,aj as F,u as g,av as u,r as C,j as t,K as v,B as c,a as p,af as L,aw as w,am as S,i as D,aR as E,bc as q,be as P,F as _}from"./index.4c1d9a77.js";import{U as A}from"./index.60d7899b.js";import{C as I}from"./index.a3c7e22f.js";import{A as x,P as N}from"./index.8cb05232.js";import{C as T,D as U}from"./DelPopconfirm.2173276f.js";import"./index.dd410d34.js";import{c as j}from"./convertNullToUndefined.a19d8223.js";import{i as G}from"./use-immer.module.3e4f1e58.js";import{t as R}from"./index.54db3b9c.js";import{I as V}from"./image.e242b103.js";import{I as z}from"./index.f1fbcaa8.js";import{I as O}from"./index.95b8c859.js";import"./index.f63ae92b.js";import"./index.63498f9e.js";import"./index.f69144bb.js";import"./index.48808231.js";import"./b-tween.es.064e2a03.js";import"./index.725a27de.js";import"./index.4b5bde6d.js";import"./index.48cfa5be.js";function J(r){return d.post("/api/link/query",r)}function K(r){return d.post("/api/link/detail",r)}function W(r){return d.post("/api/link/create",r)}function H(r){return d.post("/api/link/update",r)}function $(r){return d.post("/api/link/delete",r)}function M(r){return d.post("/api/link/enable",{uuid:r})}function Q(r){return d.post("/api/link/disable",{uuid:r})}function X(){return d.post("/api/link/group/query")}const y={"en-US":{"columns.keyword":"Keyword","columns.name":"Name","columns.icon":"Icon",noIcon:"Not Icon","columns.url":"Url","columns.group":"Group","columns.status":"Status","columns.status.enable":"Enable","columns.status.disable":"Disable","columns.updateAt":"update At","columns.action":"Action","columns.action.edit":"Edit","columns.action.enable":"Enable","columns.action.disable":"Disable","columns.action.delete":"Delete","linkCreate.form.error":"Information is incomplete","linkCreate.title.create":"Create Link","linkCreate.title.update":"Update Link","linkCreate.button.cancel":"Cancel","linkCreate.button.save":"Save","linkCreate.button.create":"Create","linkCreate.form.name.label":"Link Name","linkCreate.form.name.required":"Please enter the link name","linkCreate.form.name.placeholder":"Please enter the link name","linkCreate.form.icon.label":"Link Icon","linkCreate.form.icon.placeholder":"Please select the link icon","linkCreate.form.url.label":"Link Url","linkCreate.form.url.required":"Please enter the link url","linkCreate.form.url.placeholder":"Please enter the link url","linkCreate.form.target.label":"Target","linkCreate.form.description.label":"Link Description","linkCreate.form.description.placeholder":"Please enter the link description","linkCreate.form.group.label":"Group","linkCreate.form.group.placeholder":"Please select the group","linkCreate.form.sortIndex.label":"Sort","linkCreate.form.sortIndex.error":"Sort must be greater than 0","linkCreate.form.sortIndex.placeholder":"Please enter the sort","linkCreate.form.status.label":"Status"},"zh-CN":{"columns.keyword":"\u5173\u952E\u8BCD","columns.name":"\u540D\u5B57","columns.icon":"\u56FE\u6807",noIcon:"\u6682\u65E0\u56FE\u6807","columns.url":"\u7F51\u5740","columns.group":"\u5206\u7EC4","columns.status":"\u542F\u7528\u72B6\u6001","columns.status.enable":"\u542F\u7528","columns.status.disable":"\u7981\u7528","columns.updateAt":"\u4FEE\u6539\u65F6\u95F4","columns.action":"\u64CD\u4F5C","columns.action.edit":"\u7F16\u8F91","columns.action.enable":"\u542F\u7528","columns.action.disable":"\u7981\u7528","columns.action.delete":"\u5220\u9664","linkCreate.form.error":"\u4FE1\u606F\u4E0D\u5B8C\u6574","linkCreate.title.create":"\u521B\u5EFA\u53CB\u94FE","linkCreate.title.update":"\u4FEE\u6539\u53CB\u94FE","linkCreate.button.cancel":"\u53D6\u6D88","linkCreate.button.save":"\u4FDD\u5B58","linkCreate.button.create":"\u521B\u5EFA","linkCreate.form.name.label":"\u53CB\u94FE\u540D\u79F0","linkCreate.form.name.required":"\u8BF7\u8F93\u5165\u53CB\u94FE\u540D\u79F0","linkCreate.form.name.placeholder":"\u8BF7\u8F93\u5165\u53CB\u94FE\u540D\u79F0","linkCreate.form.icon.label":"\u53CB\u94FE\u56FE\u6807","linkCreate.form.icon.placeholder":"\u8BF7\u9009\u62E9\u53CB\u94FE\u56FE\u6807","linkCreate.form.url.label":"\u53CB\u94FE\u5730\u5740","linkCreate.form.url.required":"\u8BF7\u8F93\u5165\u53CB\u94FE\u5730\u5740","linkCreate.form.url.placeholder":"\u8BF7\u8F93\u5165\u53CB\u94FE\u5730\u5740","linkCreate.form.target.label":"\u8DF3\u8F6C\u65B9\u5F0F","linkCreate.form.description.label":"\u53CB\u94FE\u63CF\u8FF0","linkCreate.form.description.placeholder":"\u8BF7\u8F93\u5165\u53CB\u94FE\u63CF\u8FF0","linkCreate.form.group.label":"\u5206\u7EC4","linkCreate.form.group.placeholder":"\u8BF7\u9009\u62E9\u5206\u7EC4","linkCreate.form.sortIndex.label":"\u6392\u5E8F","linkCreate.form.sortIndex.error":"\u6392\u5E8F\u5FC5\u987B\u5927\u4E8E0","linkCreate.form.sortIndex.placeholder":"\u8BF7\u8F93\u5165\u6392\u5E8F","linkCreate.form.status.label":"\u542F\u7528"}},Y=F.TextArea,{Option:Z}=x;function ee(r){const e=g(y),[i]=u.useForm(),[h,k]=C.exports.useState(!1);async function m(){i.validate().then(async a=>{k(!0);try{const s={...a,icon:a.icon&&a.icon.length!==0?a.icon[0].response.data.name:void 0,detail_images:a.detail_images&&a.detail_images.length!==0?JSON.stringify(a.detail_images.map(b=>b.response.data.name)):void 0,status:a.status?"true":"false",sort_index:a.sort_index||1};let f;r.data?f=await H({...s,uuid:r.data.uuid}):f=await W(s),f.code===0&&(r.reload(),r.close())}finally{k(!1)}}).catch(()=>{console.error(e["linkCreate.form.error"])})}return C.exports.useEffect(()=>{if(r.data){const a=j(r.data),s=a.icon;i.setFieldsValue({...a,icon:a.icon?[{uid:a.icon,url:s,response:{data:{name:a.icon.replace("/media/image?n=",""),path:a.icon}}}]:[]})}},[r.data]),C.exports.useEffect(()=>{r.visible===!1&&i.resetFields()},[i,r.visible]),t(I,{title:r.data?e["linkCreate.title.update"]:e["linkCreate.title.create"],extra:t(v,{style:{cursor:"point",color:"#333",fontSize:"16px"},onClick:()=>r.close()}),actions:[t(c,{type:"default",onClick:()=>r.close(),children:e["linkCreate.button.cancel"]},"cancel"),t(c,{type:"primary",loading:h,onClick:m,children:r.data?e["linkCreate.button.save"]:e["linkCreate.button.create"]},"submit")],children:p(u,{form:i,labelCol:{span:2},wrapperCol:{span:22},children:[t(u.Item,{label:e["linkCreate.form.name.label"],field:"name",rules:[{required:!0,message:e["linkCreate.form.name.required"]}],children:t(F,{maxLength:100,showWordLimit:!0,placeholder:e["linkCreate.form.name.placeholder"]})}),t(u.Item,{label:e["linkCreate.form.icon.label"],field:"icon",triggerPropName:"fileList",children:t(A,{action:"/api/upload/image",data:{token:JSON.parse(localStorage.getItem("token")).token},imagePreview:!0,accept:"image/png, image/jpg, image/jpeg",listType:"picture-card",limit:1})}),t(u.Item,{label:e["linkCreate.form.url.label"],field:"url",rules:[{required:!0,message:e["linkCreate.form.url.required"]}],children:t(F,{maxLength:200,placeholder:e["linkCreate.form.url.placeholder"]})}),t(u.Item,{label:e["linkCreate.form.target.label"],field:"target",initialValue:"_blank",children:t(L,{options:r.target})}),t(u.Item,{label:e["linkCreate.form.description.label"],field:"description",children:t(Y,{maxLength:200,placeholder:e["linkCreate.form.description.placeholder"],showWordLimit:!0,autoSize:!0,style:{minHeight:64}})}),t(u.Item,{label:e["linkCreate.form.group.label"],field:"group",wrapperCol:{span:2},children:t(x,{placeholder:e["linkCreate.form.group.placeholder"],children:r.group.map(a=>t(Z,{value:a,children:a},a))})}),t(u.Item,{label:e["linkCreate.form.sortIndex.label"],field:"sort_index",wrapperCol:{span:2},initialValue:1,rules:[{validator(a,s){a&&a<1?s(e["linkCreate.form.sortIndex.error"]):s()}}],children:t(w,{maxLength:10,hideControl:!0,precision:0,placeholder:e["linkCreate.form.sortIndex.placeholder"]})}),t(u.Item,{label:e["linkCreate.form.status.label"],field:"status",triggerPropName:"checked",initialValue:!1,children:t(S,{})})]})})}function Ee(){const r=g(D),e=g(y),i=C.exports.useRef(),[h,k]=C.exports.useState([]),[m,a]=G({visible:!1,close:function(){a(n=>{n.visible=!1})}}),[s,f]=C.exports.useState([]);async function b(n){try{const l=await K({uuid:n});l.code===0&&a(o=>{o.data=l.data,o.visible=!0})}catch{}}C.exports.useEffect(()=>{R().then(n=>{const l=[];for(const o in n.data)l.push({value:o,label:n.data[o]});k(l)}),X().then(n=>{f(n.data||[])})},[]);const B=[{title:e["columns.keyword"],dataIndex:"keyword",search:!0,hide:!0},{title:e["columns.name"],dataIndex:"name",ellipsis:!0},{title:e["columns.icon"],width:150,dataIndex:"icon",render:(n,l)=>{if(l.icon){let o="";return o=l.icon,t(V,{width:40,height:40,src:o})}else return e["columns.noIcon"]}},{title:e["columns.url"],dataIndex:"url"},{title:e["columns.group"],dataIndex:"group"},{title:e["columns.status"],dataIndex:"status",render(n,l){return l.status===1?t(E,{color:"green",children:e["columns.status.enable"]}):t(E,{color:"red",children:e["columns.status.disable"]})}},{title:e["columns.updateAt"],dataIndex:"updated_at"},{title:e["columns.action"],width:280,render:(n,l)=>p(T,{children:[p(c,{type:"text",onClick:()=>b(l.uuid),children:[t(q,{}),e["columns.action.edit"]]}),l.status===0?p(c,{type:"text",onClick:async()=>{(await M(l.uuid)).code===0&&i.current.reload()},children:[t(z,{}),e["columns.action.enable"]]}):p(c,{type:"text",onClick:async()=>{(await Q(l.uuid)).code===0&&i.current.reload()},children:[t(P,{}),e["columns.action.disable"]]}),t(U,{reqDel:$,params:{uuid:l.uuid},reload:()=>i.current.reload(),children:p(c,{type:"text",children:[t(O,{}),e["columns.action.delete"]]})})]})}];return p(_,{children:[m.visible&&t(ee,{visible:m.visible,data:m.data,close:()=>m.close(),reload:()=>i.current.reload(),target:h,group:s}),t(I,{style:{display:m.visible?"none":void 0},children:t(N,{ref:i,request:J,columns:B,actionBarRender:[t(c,{type:"primary",onClick:()=>i.current.reload(),children:r["table.refresh"]},"refresh")],toolBarRender:[t(c,{type:"primary",onClick:()=>{a(n=>{n.visible=!0,n.data=void 0})},children:r["table.createFriendlyLinks"]},"create")]})})]})}export{Ee as default};
