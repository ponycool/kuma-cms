import{h as p,aj as n,av as r,r as c,j as e,K as g,B as f,a as m,af as F,aS as O,bf as k,F as A}from"./index.1ea05cfd.js";import{C as b}from"./index.5d39cfcf.js";import{P}from"./index.79c518c4.js";import{C as S,D as w}from"./DelPopconfirm.d371163c.js";import{c as j}from"./convertNullToUndefined.a19d8223.js";import{i as T}from"./use-immer.module.5d742fc7.js";import{I as q}from"./index.0563d606.js";import{I as L}from"./index.9290dc81.js";import"./index.abd96008.js";import"./b-tween.es.064e2a03.js";import"./index.8a2de21f.js";import"./index.21e64c28.js";function V(t){return p.post("/api/message/query",t)}function _(t){return p.post("/api/message/detail",t)}function R(t){return p.post("/api/message/delete",t)}function z(){return p.post("/api/message/status")}const H=n.TextArea;function M(t){const[o]=r.useForm();return c.exports.useEffect(()=>{if(t.data){const u=j(t.data);o.setFieldsValue({...u})}},[t.data]),c.exports.useEffect(()=>{t.visible===!1&&o.resetFields()},[o,t.visible]),e(b,{title:"\u6D88\u606F\u8BE6\u60C5",extra:e(g,{style:{cursor:"point",color:"#333",fontSize:"16px"},onClick:()=>t.close()}),actions:[e(f,{type:"default",onClick:()=>t.close(),children:"\u5173\u95ED"},"cancel")],children:m(r,{form:o,labelCol:{span:2},wrapperCol:{span:8},children:[e(r.Item,{label:"\u5BA2\u6237\u59D3\u540D",field:"name",children:e(n,{readOnly:!0})}),e(r.Item,{label:"\u624B\u673A",field:"phone",children:e(n,{readOnly:!0})}),e(r.Item,{label:"\u90AE\u7BB1",field:"email",children:e(n,{readOnly:!0})}),e(r.Item,{label:"\u6765\u6E90",field:"source",children:e(n,{readOnly:!0})}),e(r.Item,{label:"\u72B6\u6001",field:"status",children:e(F,{options:t.status,disabled:!0})}),e(r.Item,{label:"\u516C\u53F8\u540D\u79F0",field:"company",children:e(n,{readOnly:!0})}),e(r.Item,{label:"\u4E3B\u9898",field:"subject",children:e(n,{readOnly:!0})}),e(r.Item,{label:"\u5185\u5BB9",field:"content",wrapperCol:{span:22},children:e(H,{autoSize:!0,style:{minHeight:64},readOnly:!0})})]})})}function te(){const t=O(),o=k(),u=new URLSearchParams(o.search),C=u.get("name")==="null"?void 0:u.get("name"),x=u.get("phone")==="null"?void 0:u.get("phone"),B=u.get("email")==="null"?void 0:u.get("email"),d=c.exports.useRef(),[s,y]=T({visible:!1,close:function(){y(i=>{i.visible=!1})}}),[h,I]=c.exports.useState([]);async function D(i){try{const a=await _({uuid:i});a.code===0&&y(l=>{l.data=a.data,l.visible=!0})}catch{}}c.exports.useEffect(()=>{z().then(i=>{const a=[];for(const l in i.data)i.data[l]!==""&&a.push({label:i.data[l],value:l});I(a)})},[]),c.exports.useEffect(()=>{s.visible||d.current.reload()},[s.visible]);const v=[{title:"ID",dataIndex:"id"},{title:"\u5BA2\u6237\u59D3\u540D",dataIndex:"name",ellipsis:!0,search:!0,initialValue:C,fieldProps:{readOnly:!0}},{title:"\u624B\u673A",dataIndex:"phone",search:!0,initialValue:x,ellipsis:!0,copy:!0,fieldProps:{readOnly:!0}},{title:"\u90AE\u7BB1",dataIndex:"email",search:!0,initialValue:B,ellipsis:!0,copy:!0,fieldProps:{readOnly:!0}},{title:"\u516C\u53F8\u540D\u79F0",dataIndex:"company"},{title:"\u6CE8\u518C\u6765\u6E90",dataIndex:"registration_source"},{title:"\u6D41\u91CF\u6765\u6E90",dataIndex:"traffic_source"},{title:"\u72B6\u6001",dataIndex:"status",render(i,a){var l;return(l=h.find(E=>E.value===a.status))==null?void 0:l.label},search:!0,valueType:"select",fieldProps:{options:h}},{title:"\u5173\u952E\u8BCD",dataIndex:"keyword",search:!0,hide:!0},{title:"\u64CD\u4F5C",width:240,render:(i,a)=>m(S,{children:[m(f,{type:"text",onClick:()=>D(a.uuid),children:[e(q,{}),"\u8BE6\u60C5"]}),e(w,{reqDel:R,params:{uuid:a.uuid},reload:()=>d.current.reload(),children:m(f,{type:"text",children:[e(L,{}),"\u5220\u9664"]})})]})}];return m(A,{children:[s.visible&&e(M,{visible:s.visible,data:s.data,close:()=>s.close(),reload:()=>d.current.reload(),status:h}),e(b,{style:{display:s.visible?"none":void 0},children:e(P,{ref:d,request:V,columns:v,immediateSearch:!0,actionBarRender:[e(f,{type:"primary",onClick:()=>t.goBack(),children:"\u8FD4\u56DE\u7EBF\u7D22\u7BA1\u7406"},"back"),e(f,{type:"primary",onClick:()=>d.current.reload(),children:"\u5237\u65B0"},"refresh")]})})]})}export{te as default};
