import{h as f,aj as b,aB as i,r as m,j as t,K as B,B as r,a as d,au as k,bb as v,M as D,u as y,i as L,aR as C,bc as S,be as A,F as T}from"./index.bbe790dc.js";import{C as E}from"./index.7f78f3d8.js";import{P as q}from"./index.a63bf2ab.js";import{i as O,C as P,D as _}from"./use-immer.module.e35981bc.js";import{c as U}from"./convertNullToUndefined.a19d8223.js";import{M as j}from"./index.6be52b2b.js";import{t as z}from"./index.90d6a055.js";import{I as M}from"./index.61cf9910.js";import{I as N}from"./index.3a3a7e0d.js";import"./index.e923ab7c.js";import"./index.57a7c61a.js";import"./index.a130295f.js";function R(e){return f.post("/api/page/query",e)}function W(e){return f.post("/api/page/detail",e)}function H(e){return f.post("/api/page/create",e)}function K(e){return f.post("/api/page/update",e)}function V(e){return f.post("/api/page/delete",e)}function G(e){return f.post("/api/page/enable",{uuid:e})}function $(e){return f.post("/api/page/disable",{uuid:e})}const x=b.TextArea;function J(e){const[l]=i.useForm(),[n,h]=m.exports.useState(!1);async function g(){l.validate().then(async a=>{h(!0);try{const o={...a,status:a.status?"true":"false"};let p;e.data?p=await K({...o,uuid:e.data.uuid||e.uuid}):p=await H(o),p.code===0&&(e.reload(),e.close())}finally{h(!1)}}).catch(a=>{if(a.errors)for(const o in a.errors)D.error(a.errors[o].message)})}return m.exports.useEffect(()=>{var a;if((a=e.data)!=null&&a.page){const o=U(e.data.page);l.setFieldsValue({...o})}},[e.data]),m.exports.useEffect(()=>{e.visible===!1&&l.resetFields()},[l,e.visible]),t(E,{title:e.data?"\u4FEE\u6539\u5355\u9875":"\u521B\u5EFA\u5355\u9875",extra:t(B,{style:{cursor:"point",color:"#333",fontSize:"16px"},onClick:()=>e.close()}),actions:[t(r,{type:"default",onClick:()=>e.close(),children:"\u53D6\u6D88"},"cancel"),t(r,{type:"primary",loading:n,onClick:g,children:e.data?"\u4FDD\u5B58":"\u521B\u5EFA"},"submit")],children:d(i,{form:l,labelCol:{span:2},wrapperCol:{span:22},children:[t(i.Item,{label:"\u6807\u9898",field:"title",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898"}],children:t(b,{maxLength:100,showWordLimit:!0,placeholder:"\u8BF7\u8F93\u5165\u6807\u9898"})}),t(i.Item,{label:"\u7F16\u7801",field:"code",wrapperCol:{span:2},children:t(b,{maxLength:50,placeholder:"\u8BF7\u8F93\u5165\u7F16\u7801"})}),t(i.Item,{label:"SEO\u6807\u9898",field:"seo_title",children:t(b,{maxLength:200,showWordLimit:!0,placeholder:"SEO\u6807\u9898"})}),t(i.Item,{label:"SEO\u63CF\u8FF0",field:"seo_desc",children:t(x,{maxLength:200,placeholder:"SEO\u63CF\u8FF0",showWordLimit:!0,autoSize:!0,style:{minHeight:64}})}),t(i.Item,{label:"SEO\u5173\u952E\u8BCD",field:"seo_keywords",children:t(x,{maxLength:200,placeholder:"SEO\u5173\u952E\u8BCD",showWordLimit:!0,autoSize:!0,style:{minHeight:64}})}),t(i.Item,{label:"\u542F\u7528",field:"status",triggerPropName:"checked",initialValue:!1,children:t(k,{})}),t(v,{orientation:"left",children:"\u6B63\u6587"}),t(i.Item,{field:"content",wrapperCol:{span:24},triggerPropName:"html",trigger:"getContent",rules:[{required:!0},{validator(a,o){if(a==="<p><br></p>")return o("\u8BF7\u8F93\u5165\u6B63\u6587");o()}}],children:t(j,{})})]})})}const Q={"en-US":{"columns.keyword":"Keyword","columns.title":"Title","columns.code":"Code","columns.status":"Status","columns.status.enabled":"Enabled","columns.status.disabled":"Disabled","columns.updatedAt":"Updated At","columns.action":"Action","columns.action.edit":"Edit","columns.action.enable":"Enable","columns.action.disable":"Disable","columns.action.delete":"Delete"},"zh-CN":{"columns.keyword":"\u5173\u952E\u8BCD","columns.title":"\u6807\u9898","columns.code":"\u7F16\u7801","columns.status":"\u542F\u7528\u72B6\u6001","columns.status.enabled":"\u542F\u7528","columns.status.disabled":"\u7981\u7528","columns.updatedAt":"\u4FEE\u6539\u65F6\u95F4","columns.action":"\u64CD\u4F5C","columns.action.edit":"\u7F16\u8F91","columns.action.enable":"\u542F\u7528","columns.action.disable":"\u7981\u7528","columns.action.delete":"\u5220\u9664"}};function re(){const e=y(Q),l=y(L),n=m.exports.useRef(),[h,g]=m.exports.useState([]),[a,o]=O({visible:!1,close:function(){o(s=>{s.visible=!1})}}),[p,F]=m.exports.useState();async function I(s){try{const u=await W({uuid:s});u.code===0&&(F(s),o(c=>{c.data=u.data,c.visible=!0}))}catch{}}m.exports.useEffect(()=>{z().then(s=>{const u=[];for(const c in s.data)u.push({value:c,label:s.data[c]});g(u)})},[]);const w=[{title:e["columns.keyword"],dataIndex:"keyword",search:!0,hide:!0},{title:e["columns.title"],dataIndex:"title",ellipsis:!0},{title:e["columns.code"],dataIndex:"code"},{title:e["columns.status"],dataIndex:"status",render(s,u){return u.status===1?t(C,{color:"green",children:e["columns.status.enabled"]}):t(C,{color:"red",children:e["columns.status.disabled"]})}},{title:e["columns.updateAt"],dataIndex:"updated_at"},{title:e["columns.action"],width:280,render:(s,u)=>d(P,{children:[d(r,{type:"text",onClick:()=>I(u.uuid),children:[t(S,{}),e["columns.action.edit"]]}),u.status===0?d(r,{type:"text",onClick:async()=>{(await G(u.uuid)).code===0&&n.current.reload()},children:[t(M,{}),e["columns.action.enable"]]}):d(r,{type:"text",onClick:async()=>{(await $(u.uuid)).code===0&&n.current.reload()},children:[t(A,{}),e["columns.action.disable"]]}),t(_,{reqDel:V,params:{uuid:u.uuid},reload:()=>n.current.reload(),children:d(r,{type:"text",children:[t(N,{}),e["columns.action.delete"]]})})]})}];return d(T,{children:[a.visible&&t(J,{visible:a.visible,data:a.data,close:()=>a.close(),reload:()=>n.current.reload(),target:h,uuid:p}),t(E,{style:{display:a.visible?"none":void 0},children:t(q,{ref:n,request:R,columns:w,actionBarRender:[t(r,{type:"primary",onClick:()=>n.current.reload(),children:l["table.refresh"]},"refresh")],toolBarRender:[t(r,{type:"primary",onClick:()=>{F(void 0),o(s=>{s.visible=!0,s.data=void 0})},children:l["table.createPage"]},"create")]})})]})}export{re as default};
