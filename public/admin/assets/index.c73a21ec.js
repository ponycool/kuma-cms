import{R as D,r as l,g as P,j as a,_ as B,aS as W,bc as q,af as N,am as k,a as f,F as O,ad as z,B as K,M as v}from"./index.d99aab39.js";import{C as S}from"./index.aebb8f80.js";import{P as Y}from"./index.a7fff3df.js";import"./index.9daf3267.js";import"./index.458a93f7.js";function w(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,t)}return r}function A(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?w(Object(r),!0).forEach(function(t){B(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function V(e,n){var r=l.exports.useContext(P),t=r.prefixCls,o=t===void 0?"arco":t,u=e.spin,i=e.className,c=A(A({"aria-hidden":!0,focusable:!1,ref:n},e),{},{className:"".concat(i?i+" ":"").concat(o,"-icon ").concat(o,"-icon-exclamation-circle")});return u&&(c.className="".concat(c.className," ").concat(o,"-icon-loading")),delete c.spin,delete c.isIcon,a("svg",{fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48",...c,children:a("path",{d:"M24 28V14m0 16v4M6 24c0-9.941 8.059-18 18-18s18 8.059 18 18-8.059 18-18 18S6 33.941 6 24Z"})})}var F=D.forwardRef(V);F.defaultProps={isIcon:!0};F.displayName="IconExclamationCircle";var Z=F;function I(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,t)}return r}function j(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?I(Object(r),!0).forEach(function(t){B(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function H(e,n){var r=l.exports.useContext(P),t=r.prefixCls,o=t===void 0?"arco":t,u=e.spin,i=e.className,c=j(j({"aria-hidden":!0,focusable:!1,ref:n},e),{},{className:"".concat(i?i+" ":"").concat(o,"-icon ").concat(o,"-icon-code")});return u&&(c.className="".concat(c.className," ").concat(o,"-icon-loading")),delete c.spin,delete c.isIcon,a("svg",{fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48",...c,children:a("path",{d:"M16.734 12.686 5.42 24l11.314 11.314m14.521-22.628L42.57 24 31.255 35.314M27.2 6.28l-6.251 35.453"})})}var C=D.forwardRef(H);C.defaultProps={isIcon:!0};C.displayName="IconCode";var J=C;function g(){localStorage.removeItem("userStatus");const e="/login";window.location.href=`${e}`}const Q=()=>{let e="/api";return e=`${void 0}/api`,{baseURL:e,timeout:1e4}},m=W.create(Q());m.interceptors.request.use(async function(e){if(e.url.split("/")[1]!=="open"){e.data||(e.data={token:""});const t=localStorage.getItem("token");if(t||g(),t){const o=localStorage.getItem("iat"),u=localStorage.getItem("expiresIn"),i=localStorage.getItem("expiredAt");parseInt(o)+parseInt(u)!==parseInt(i)&&(console.log("\u53D1\u5E03\u65F6\u95F4\uFF1A"+o),console.log("\u8FC7\u671F\u65F6\u95F4\uFF1A"+i),console.log("\u4EE4\u724C\u8FC7\u671F\u65F6\u95F4\u4E0D\u4E00\u81F4"),g()),Math.floor(Date.now()/1e3)>parseInt(i)&&(console.log("\u4EE4\u724C\u5DF2\u8FC7\u671F"),g())}e.data.token=t}return e},function(e){return Promise.reject(e)});m.interceptors.response.use(function(e){const{status:n,data:r}=e;if(n===200){const{code:t,message:o}=r;if(t===4&&(console.log(o),g()),t===0){let{data:u}=r;delete r.data,q(u)&&(u={list:u}),e.data={...r,...u}}}return e},function(e){return Promise.reject(e)});function X(e){return m({url:"/database/table/query",method:"post",data:e})}function ee(e){return m({url:"/scaffold/entity",method:"post",data:e})}function te(e){return m({url:"/scaffold/model",method:"post",data:e})}function re(e){return m({url:"/scaffold/service",method:"post",data:e})}const ne=N.Option,ae=k.Group,oe=["\u5B9E\u4F53","\u6A21\u578B","\u670D\u52A1"],se={\u5B9E\u4F53:ee,\u6A21\u578B:te,\u670D\u52A1:re};function pe(){const[e,n]=l.exports.useState([]),[r,t]=l.exports.useState([]),[o,u]=l.exports.useState(!1),[i,c]=l.exports.useState(!1),[x,_]=l.exports.useState(""),[L,M]=l.exports.useState("false"),[h,$]=l.exports.useState([]),[T,b]=l.exports.useState(0),R=()=>{u(!0),X({}).then(s=>{const p=s.data.tables;t(p||[]),u(!1)})};l.exports.useEffect(()=>{R()},[]);const G=async()=>{if(n([]),b(0),x===""||x===void 0)return v.error("\u8BF7\u9009\u62E9\u6570\u636E\u8868"),!1;if(h.length===0)return v.error("\u8BF7\u9009\u62E9\u8981\u751F\u6210\u7684\u6587\u4EF6"),!1;c(!0);let s=0;const p=h.length,y=[];for(const E of h){s++;const U=se[E];try{const d=await U({table:x,overwrite:L});d&&d.data&&d.data.message&&y.push(d.data.message),b(Math.round(s/p*100)),n(y)}catch(d){console.error(`\u521B\u5EFA${E}\u63A5\u53E3\u8BF7\u6C42\u51FA\u9519\uFF1A`,d)}}};return f(O,{children:[a(S,{children:a(z,{children:a(N,{prefix:"\u6570\u636E\u8868",showSearch:!0,allowClear:!0,placeholder:"\u8BF7\u9009\u62E9\u6570\u636E\u8868",style:{width:"300px"},loading:o,onChange:s=>{_(s),b(0),c(!1),n([])},children:r.map(s=>a(ne,{value:s.slice(2),children:s.slice(2)},s.slice(2)))},"tableName")})}),f(S,{style:{marginTop:"20px",paddingLeft:"10px"},children:[a("span",{children:"\u751F\u6210\u7C7B\u578B"}),"\xA0\xA0",a(ae,{options:oe,onChange:s=>{$(s)}}),a("br",{}),a("br",{}),a("span",{children:"\u6587\u4EF6\u91CD\u5199"}),"\xA0\xA0",a(k,{onChange:s=>{M(s.toString())}}),a("br",{}),f("span",{style:{fontSize:"10px",marginLeft:"70px"},children:[a(Z,{}),"\u6CE8:\u9009\u62E9\u6587\u4EF6\u91CD\u5199,\u4F1A\u8986\u76D6\u5DF2\u751F\u6210\u6587\u4EF6"]}),i?f(O,{children:[a("br",{}),a("span",{children:"\u751F\u6210\u8FDB\u5EA6"}),"\xA0\xA0"," ",a(Y,{steps:5,size:"small",percent:T})," ",a("br",{})]}):"",a("br",{}),f("div",{style:{display:"flex"},children:[a("span",{children:"\u751F\u6210\u65E5\u5FD7"}),"\xA0\xA0",a("ol",{style:{height:"20vh",width:"35vw",overflow:"auto",backgroundColor:"#f5f5f5",padding:"0",margin:"5px"},children:e.map((s,p)=>f("li",{style:{listStyle:"none"},children:[f("span",{children:["\xA0",p+1,"\xA0\xA0\xA0\xA0"]}),s]},p))})]}),a("br",{}),f(K,{style:{marginLeft:"4.3%"},type:"primary",onClick:G,children:[a(J,{}),"\u751F\u6210"]},"generateBtn")]})]})}export{pe as default};
