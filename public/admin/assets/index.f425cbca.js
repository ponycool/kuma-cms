import{h as f,aj as b,aB as i,r as m,j as t,K as w,B as r,a as d,au as k,bb as v,M as D,u as y,i as L,bc as S,be as A,F as T}from"./index.6baa9237.js";import{C as E}from"./index.adedcd4b.js";import{B as C}from"./index.92f77a41.js";import{P as q}from"./index.ba639177.js";import{i as O,C as P,D as _}from"./use-immer.module.1f7d219c.js";import{c as U}from"./convertNullToUndefined.a19d8223.js";import{M as j}from"./index.749db958.js";import{t as z}from"./index.84436c4c.js";import{I as M}from"./index.70f84d3d.js";import{I as N}from"./index.3d88a473.js";import"./index.d3eb644a.js";import"./index.1ec5f8a4.js";import"./index.72406e2d.js";function W(e){return f.post("/api/page/query",e)}function R(e){return f.post("/api/page/detail",e)}function H(e){return f.post("/api/page/create",e)}function K(e){return f.post("/api/page/update",e)}function V(e){return f.post("/api/page/delete",e)}function G(e){return f.post("/api/page/enable",{uuid:e})}function $(e){return f.post("/api/page/disable",{uuid:e})}const x=b.TextArea;function J(e){const[n]=i.useForm(),[l,h]=m.exports.useState(!1);async function g(){n.validate().then(async a=>{h(!0);try{const s={...a,status:a.status?"true":"false"};let p;e.data?p=await K({...s,uuid:e.data.uuid||e.uuid}):p=await H(s),p.code===0&&(e.reload(),e.close())}finally{h(!1)}}).catch(a=>{if(a.errors)for(const s in a.errors)D.error(a.errors[s].message)})}return m.exports.useEffect(()=>{var a;if((a=e.data)!=null&&a.page){const s=U(e.data.page);n.setFieldsValue({...s})}},[e.data]),m.exports.useEffect(()=>{e.visible===!1&&n.resetFields()},[n,e.visible]),t(E,{title:e.data?"\u4FEE\u6539\u5355\u9875":"\u521B\u5EFA\u5355\u9875",extra:t(w,{style:{cursor:"point",color:"#333",fontSize:"16px"},onClick:()=>e.close()}),actions:[t(r,{type:"default",onClick:()=>e.close(),children:"\u53D6\u6D88"},"cancel"),t(r,{type:"primary",loading:l,onClick:g,children:e.data?"\u4FDD\u5B58":"\u521B\u5EFA"},"submit")],children:d(i,{form:n,labelCol:{span:2},wrapperCol:{span:22},children:[t(i.Item,{label:"\u6807\u9898",field:"title",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898"}],children:t(b,{maxLength:100,showWordLimit:!0,placeholder:"\u8BF7\u8F93\u5165\u6807\u9898"})}),t(i.Item,{label:"\u7F16\u7801",field:"code",wrapperCol:{span:2},children:t(b,{maxLength:50,placeholder:"\u8BF7\u8F93\u5165\u7F16\u7801"})}),t(i.Item,{label:"SEO\u6807\u9898",field:"seo_title",children:t(b,{maxLength:200,showWordLimit:!0,placeholder:"SEO\u6807\u9898"})}),t(i.Item,{label:"SEO\u63CF\u8FF0",field:"seo_desc",children:t(x,{maxLength:200,placeholder:"SEO\u63CF\u8FF0",showWordLimit:!0,autoSize:!0,style:{minHeight:64}})}),t(i.Item,{label:"SEO\u5173\u952E\u8BCD",field:"seo_keywords",children:t(x,{maxLength:200,placeholder:"SEO\u5173\u952E\u8BCD",showWordLimit:!0,autoSize:!0,style:{minHeight:64}})}),t(i.Item,{label:"\u542F\u7528",field:"status",triggerPropName:"checked",initialValue:!1,children:t(k,{})}),t(v,{orientation:"left",children:"\u6B63\u6587"}),t(i.Item,{field:"content",wrapperCol:{span:24},triggerPropName:"html",trigger:"getContent",rules:[{required:!0},{validator(a,s){if(a==="<p><br></p>")return s("\u8BF7\u8F93\u5165\u6B63\u6587");s()}}],children:t(j,{})})]})})}const Q={"en-US":{"columns.keyword":"Keyword","columns.title":"Title","columns.code":"Code","columns.status":"Status","columns.status.enabled":"Enabled","columns.status.disabled":"Disabled","columns.updatedAt":"Updated At","columns.action":"Action","columns.action.edit":"Edit","columns.action.enable":"Enable","columns.action.disable":"Disable","columns.action.delete":"Delete"},"zh-CN":{"columns.keyword":"\u5173\u952E\u8BCD","columns.title":"\u6807\u9898","columns.code":"\u7F16\u7801","columns.status":"\u542F\u7528\u72B6\u6001","columns.status.enabled":"\u542F\u7528","columns.status.disabled":"\u7981\u7528","columns.updatedAt":"\u4FEE\u6539\u65F6\u95F4","columns.action":"\u64CD\u4F5C","columns.action.edit":"\u7F16\u8F91","columns.action.enable":"\u542F\u7528","columns.action.disable":"\u7981\u7528","columns.action.delete":"\u5220\u9664"}};function ce(){const e=y(Q),n=y(L),l=m.exports.useRef(),[h,g]=m.exports.useState([]),[a,s]=O({visible:!1,close:function(){s(o=>{o.visible=!1})}}),[p,F]=m.exports.useState();async function B(o){try{const u=await R({uuid:o});u.code===0&&(F(o),s(c=>{c.data=u.data,c.visible=!0}))}catch{}}m.exports.useEffect(()=>{z().then(o=>{const u=[];for(const c in o.data)u.push({value:c,label:o.data[c]});g(u)})},[]);const I=[{title:e["columns.keyword"],dataIndex:"keyword",search:!0,hide:!0},{title:e["columns.title"],dataIndex:"title",ellipsis:!0},{title:e["columns.code"],dataIndex:"code"},{title:e["columns.status"],dataIndex:"status",render(o,u){return u.status===1?t(C,{status:"success",text:e["columns.status.enabled"]}):t(C,{status:"error",text:e["columns.status.disabled"]})}},{title:e["columns.updateAt"],dataIndex:"updated_at"},{title:e["columns.action"],width:280,render:(o,u)=>d(P,{children:[d(r,{type:"text",onClick:()=>B(u.uuid),children:[t(S,{}),e["columns.action.edit"]]}),u.status===0?d(r,{type:"text",onClick:async()=>{(await G(u.uuid)).code===0&&l.current.reload()},children:[t(M,{}),e["columns.action.enable"]]}):d(r,{type:"text",onClick:async()=>{(await $(u.uuid)).code===0&&l.current.reload()},children:[t(A,{}),e["columns.action.disable"]]}),t(_,{reqDel:V,params:{uuid:u.uuid},reload:()=>l.current.reload(),children:d(r,{type:"text",children:[t(N,{}),e["columns.action.delete"]]})})]})}];return d(T,{children:[a.visible&&t(J,{visible:a.visible,data:a.data,close:()=>a.close(),reload:()=>l.current.reload(),target:h,uuid:p}),t(E,{style:{display:a.visible?"none":void 0},children:t(q,{ref:l,request:W,columns:I,actionBarRender:[t(r,{type:"primary",onClick:()=>l.current.reload(),children:n["table.refresh"]},"refresh")],toolBarRender:[t(r,{type:"primary",onClick:()=>{F(void 0),s(o=>{o.visible=!0,o.data=void 0})},children:n["table.createPage"]},"create")]})})]})}export{ce as default};
